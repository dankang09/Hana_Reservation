{% extends "login_base/base_with_navbar.html" %}

{% load static %}

{% block css %}
  <link rel="stylesheet" href="{% static 'booking/css/profile.css' %}">  
{% endblock css %}

{% block title %}{{ profile_user.name }} | Hana Booking{% endblock title %} 

{% block content %}
<main class="site-body">
  <div class="profile-header">
    <div class="content max-content-width">
      <div
        class="cp-avatar large profile-pic" style="background-image: url('{{ profile_user.profile_pic.url }}')"></div>
      <div class="info">
        <h1 class="username"> {{ profile_user.name }}</h1>
        {% if profile_user == user %}
        <a class="edit" href="{% url 'login:profile-update' %}">
          <img class="cp-icon small" src="{% static 'login/icons/ic-pen.svg' %}" alt="Pen Icon">
          프로필 수정
        </a>
        &#183;
        <a class="edit" href="{% url 'account_change_password' %}">
          비밀번호 변경
        </a>
        {% endif %}
        {% if profile_user.intro %}
        <div>
          <p class="cp-chip intro">{{ profile_user.intro }}</p>
        </div>
        {% endif %}
      </div>

      <div class="follow-section">
        {% comment %} <a href="#">
          팔로워 [A: 팔로워 수]
        </a>
        <span class="vert-divider">|</span> {% endcomment %}
        <a href="#">
          자주가는 지점 {{ profile_user.following.count }}
        </a>
      </div>
      {% comment %} <form class="follow-button" action="#" method="post">
        {% csrf_token %}
        <button class="cp-button small" type="submit">
          팔로우
        </button>
      </form> {% endcomment %}

    </div>
  </div>

  <div class="content-list max-content-width">
    <div class="header">
      <h2>{{ profile_user.name }}님의 예약 현황</h2>
      <p class='help'> 예약은 가장 최근 4건 까지만 보여요 :)</p>
      <a class="cp-ic-button after circle morereview" href="{% url 'booking:branch-list' %}">
        지점 전체보기
      </a>
    </div>

    <div class="contents">
      {% for booking in user_bookings %}
      <a href="{% url 'booking:booking-detail' booking.id %}">
        <div class="cp-card content">
          <div
            class="thumb"
            style="background-image: url('{{ booking.image1.url }}');"
          ></div>
          <div class="body">
            <span class="cp-chip green">{{ booking.booking_branch.branch_name }} 지점</span>
            <h2 class="title">{{ booking.booking_branch.branch_address }}</h2>
            <date class="date">{{ booking.booking_dates|date:"Y년 n월 j일" }}</date>
            <div class="metadata">
              <div class="review-rating">
                <span class="cp-stars">
                  {% comment %} {% for i in ""|ljust:review.rating %}★{% endfor %} {% endcomment %}
                </span>
              </div>
              <div class="review-author">
                <div
                  class="cp-avatar"
                  style="background-image: url('{{ booking.booking_client.profile_pic.url }}')">
                </div>
                <span>{{ booking.booking_client.name }}</span>
              </div>
            </div>
          </div>
        </div>
      </a>
      {% empty %}
      <p class="empty">아직 예약이 없어요 :(</p>
      {% endfor %}
      
    </div>
  </div>
</main>
{% endblock content %}
